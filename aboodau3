local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local HttpService = game:GetService("HttpService")

local plr = Players.LocalPlayer
local currentPrefix = ";" 
local attackCommands = { "logs [target]", "re [target]" } 

-- [ نظام الحفظ ]
local function SaveCommands()
    pcall(function() writefile("NeonAttack_Config.json", HttpService:JSONEncode(attackCommands)) end)
end

local function LoadCommands()
    pcall(function()
        if isfile and isfile("NeonAttack_Config.json") then
            attackCommands = HttpService:JSONDecode(readfile("NeonAttack_Config.json"))
        end
    end)
end
LoadCommands()

if CoreGui:FindFirstChild("NeonSystem_Final") then CoreGui.NeonSystem_Final:Destroy() end

local ScreenGui = Instance.new("ScreenGui", CoreGui)
ScreenGui.Name = "NeonSystem_Final"
ScreenGui.ResetOnSpawn = false

-- [ وظيفة الانميشن ]
local function ClickEffect(button)
    local originalSize = button.Size
    local originalColor = button.BackgroundColor3
    
    local tweenInfo = TweenInfo.new(0.05, Enum.EasingStyle.Quart, Enum.EasingDirection.Out, 0, true)
    local tween = TweenService:Create(button, tweenInfo, {
        Size = UDim2.new(originalSize.X.Scale * 1.05, originalSize.X.Offset + 5, originalSize.Y.Scale * 1.05, originalSize.Y.Offset + 5),
        BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    })
    tween:Play()
end

-- [ زر الفتح ]
local OpenBtn = Instance.new("TextButton", ScreenGui)
OpenBtn.Size = UDim2.new(0, 50, 0, 50)
OpenBtn.Position = UDim2.new(0, 10, 0.5, -25)
OpenBtn.BackgroundColor3 = Color3.fromRGB(15, 15, 17)
OpenBtn.Text = "N"
OpenBtn.TextColor3 = Color3.fromRGB(0, 255, 255)
OpenBtn.Font = Enum.Font.GothamBold
OpenBtn.Visible = false
Instance.new("UICorner", OpenBtn).CornerRadius = UDim.new(1, 0)
local OpenStroke = Instance.new("UIStroke", OpenBtn)
OpenStroke.Color = Color3.fromRGB(0, 255, 255)
OpenStroke.Thickness = 2

-- [ الإطار الرئيسي ]
local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.Size = UDim2.new(0, 360, 0, 420)
MainFrame.Position = UDim2.new(0.5, -180, 0.5, -210)
MainFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 12)
MainFrame.Active = true
MainFrame.Draggable = true
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 20)
local MainStroke = Instance.new("UIStroke", MainFrame)
MainStroke.Thickness = 3
MainStroke.Color = Color3.fromRGB(0, 255, 255)

-- [ وظيفة إنشاء العناوين ]
local function CreateLabel(txt, pos, parent)
    local lbl = Instance.new("TextLabel", parent)
    lbl.Text = txt
    lbl.Size = UDim2.new(0.85, 0, 0, 20)
    lbl.Position = pos
    lbl.BackgroundTransparency = 1
    lbl.TextColor3 = Color3.fromRGB(0, 255, 255)
    lbl.TextXAlignment = Enum.TextXAlignment.Left
    lbl.Font = Enum.Font.GothamBold
    lbl.TextSize = 12
    return lbl
end

-- [ أزرار التحكم العلوي ]
local CloseBtn = Instance.new("TextButton", MainFrame)
CloseBtn.Size = UDim2.new(0, 32, 0, 32)
CloseBtn.Position = UDim2.new(1, -45, 0, 15)
CloseBtn.BackgroundColor3 = Color3.fromRGB(255, 50, 60)
CloseBtn.Text = "X"
Instance.new("UICorner", CloseBtn).CornerRadius = UDim.new(1, 0)

local SettingsBtn = Instance.new("TextButton", MainFrame)
SettingsBtn.Size = UDim2.new(0, 32, 0, 32)
SettingsBtn.Position = UDim2.new(1, -85, 0, 15)
SettingsBtn.BackgroundColor3 = Color3.fromRGB(0, 140, 255)
SettingsBtn.Text = "⚙"
Instance.new("UICorner", SettingsBtn).CornerRadius = UDim.new(1, 0)

-- [ الخانات الرئيسية ]
CreateLabel("COMMAND BAR:", UDim2.new(0.075, 0, 0.15, 0), MainFrame)
local CommandInput = Instance.new("TextBox", MainFrame)
CommandInput.Size = UDim2.new(0.85, 0, 0, 40)
CommandInput.Position = UDim2.new(0.075, 0, 0.20, 0)
CommandInput.BackgroundColor3 = Color3.fromRGB(30, 30, 33)
CommandInput.Text = ""
CommandInput.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", CommandInput)

CreateLabel("LOOPS:", UDim2.new(0.725, 0, 0.32, 0), MainFrame)
local LoopCountInput = Instance.new("TextBox", MainFrame)
LoopCountInput.Size = UDim2.new(0.2, 0, 0, 40)
LoopCountInput.Position = UDim2.new(0.725, 0, 0.37, 0)
LoopCountInput.BackgroundColor3 = Color3.fromRGB(30, 30, 33)
LoopCountInput.Text = "50"
LoopCountInput.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", LoopCountInput)

local LoopBtn = Instance.new("TextButton", MainFrame)
LoopBtn.Size = UDim2.new(0.6, 0, 0, 40)
LoopBtn.Position = UDim2.new(0.075, 0, 0.37, 0)
LoopBtn.BackgroundColor3 = Color3.fromRGB(0, 255, 255)
LoopBtn.Text = "GIGA BLAST"
LoopBtn.Font = Enum.Font.GothamBold
Instance.new("UICorner", LoopBtn)

CreateLabel("TARGET NAME:", UDim2.new(0.075, 0, 0.55, 0), MainFrame)
local TargetInput = Instance.new("TextBox", MainFrame)
TargetInput.Size = UDim2.new(0.85, 0, 0, 40)
TargetInput.Position = UDim2.new(0.075, 0, 0.60, 0)
TargetInput.BackgroundColor3 = Color3.fromRGB(30, 30, 33)
TargetInput.Text = ""
TargetInput.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", TargetInput)

local AttackBtn = Instance.new("TextButton", MainFrame)
AttackBtn.Size = UDim2.new(0.85, 0, 0, 55)
AttackBtn.Position = UDim2.new(0.075, 0, 0.78, 0)
AttackBtn.BackgroundColor3 = Color3.fromRGB(255, 20, 60)
AttackBtn.Text = "INSTANE ATTACK: OFF"
AttackBtn.TextColor3 = Color3.new(1, 1, 1)
AttackBtn.Font = Enum.Font.GothamBold
Instance.new("UICorner", AttackBtn)

-- [ واجهة الإعدادات - معدلة للتوسيط ]
local SettingsFrame = Instance.new("Frame", ScreenGui)
SettingsFrame.Size = UDim2.new(0, 0, 0, 0)
SettingsFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
SettingsFrame.AnchorPoint = Vector2.new(0.5, 0.5)
SettingsFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 22)
SettingsFrame.Visible = false
SettingsFrame.ClipsDescendants = true
Instance.new("UICorner", SettingsFrame).CornerRadius = UDim.new(0, 25)
Instance.new("UIStroke", SettingsFrame).Color = Color3.fromRGB(0, 255, 255)

local SettingsScroll = Instance.new("ScrollingFrame", SettingsFrame)
SettingsScroll.Size = UDim2.new(1, -20, 1, -80)
SettingsScroll.Position = UDim2.new(0.5, 0, 0.5, 20)
SettingsScroll.AnchorPoint = Vector2.new(0.5, 0.5)
SettingsScroll.BackgroundTransparency = 1
SettingsScroll.CanvasSize = UDim2.new(0, 0, 0, 650)
SettingsScroll.ScrollBarThickness = 2
local ListLayout = Instance.new("UIListLayout", SettingsScroll)
ListLayout.Padding = UDim.new(0, 15)
ListLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

local SetClose = Instance.new("TextButton", SettingsFrame)
SetClose.Size = UDim2.new(0, 30, 0, 30)
SetClose.Position = UDim2.new(1, -40, 0, 15)
SetClose.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
SetClose.Text = "X"
Instance.new("UICorner", SetClose).CornerRadius = UDim.new(1, 0)

SettingsBtn.MouseButton1Click:Connect(function()
    SettingsFrame.Visible = true
    SettingsFrame:TweenSize(UDim2.new(0, 380, 0, 480), "Out", "Back", 0.5, true)
end)

SetClose.MouseButton1Click:Connect(function()
    SettingsFrame:TweenSize(UDim2.new(0, 0, 0, 0), "In", "Quart", 0.3, true, function() SettingsFrame.Visible = false end)
end)

-- [ أزرار الإعدادات ]
local function CreateSetBtn(txt, color)
    local btn = Instance.new("TextButton", SettingsScroll)
    btn.Size = UDim2.new(0.9, 0, 0, 45)
    btn.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
    btn.Text = txt
    btn.TextColor3 = Color3.new(1, 1, 1)
    Instance.new("UICorner", btn)
    Instance.new("UIStroke", btn).Color = color
    return btn
end

local PrefixInput = Instance.new("TextBox", SettingsScroll)
PrefixInput.Size = UDim2.new(0.9, 0, 0, 45)
PrefixInput.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
PrefixInput.Text = currentPrefix
PrefixInput.PlaceholderText = "Prefix..."
PrefixInput.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", PrefixInput)

local HeadlessBtn = CreateSetBtn("HIDDEN HEAD", Color3.fromRGB(0, 255, 255))
local SkyboxBtn = CreateSetBtn("SKYBOX & EMOTE", Color3.fromRGB(170, 0, 255))
local AntiSpamBtn = CreateSetBtn("ANTI SPAM: OFF", Color3.fromRGB(255, 100, 0))

local AddCmdFrame = Instance.new("Frame", SettingsScroll)
AddCmdFrame.Size = UDim2.new(0.9, 0, 0, 45)
AddCmdFrame.BackgroundTransparency = 1
local AddCmdInput = Instance.new("TextBox", AddCmdFrame)
AddCmdInput.Size = UDim2.new(0.7, 0, 1, 0)
AddCmdInput.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
AddCmdInput.PlaceholderText = "Add command..."
AddCmdInput.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", AddCmdInput)
local AddBtn = Instance.new("TextButton", AddCmdFrame)
AddBtn.Size = UDim2.new(0.25, 0, 1, 0)
AddBtn.Position = UDim2.new(0.75, 5, 0, 0)
AddBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 100)
AddBtn.Text = "ADD"
Instance.new("UICorner", AddBtn)

local CmdScroll = Instance.new("ScrollingFrame", SettingsScroll)
CmdScroll.Size = UDim2.new(0.9, 0, 0, 160)
CmdScroll.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
CmdScroll.AutomaticCanvasSize = Enum.AutomaticSize.Y
CmdScroll.ScrollBarThickness = 2
local CmdListLayout = Instance.new("UIListLayout", CmdScroll)
CmdListLayout.Padding = UDim.new(0, 5)
CmdListLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

local function UpdateCmdListUI()
    for _, v in ipairs(CmdScroll:GetChildren()) do if v:IsA("TextButton") then v:Destroy() end end
    for i, cmd in ipairs(attackCommands) do
        local b = Instance.new("TextButton", CmdScroll)
        b.Size = UDim2.new(1, -10, 0, 35)
        b.BackgroundColor3 = Color3.fromRGB(45, 45, 50)
        b.Text = cmd .. " (X)"
        b.TextColor3 = Color3.new(1, 1, 1)
        Instance.new("UICorner", b)
        b.MouseButton1Click:Connect(function() table.remove(attackCommands, i) SaveCommands() UpdateCmdListUI() end)
    end
end
UpdateCmdListUI()

AddBtn.MouseButton1Click:Connect(function() 
    if AddCmdInput.Text ~= "" then 
        local cmdText = AddCmdInput.Text
        if not cmdText:find("%[target%]") then cmdText = cmdText .. " [target]" end
        table.insert(attackCommands, cmdText) 
        SaveCommands() 
        AddCmdInput.Text = "" 
        UpdateCmdListUI() 
    end 
end)

-- [ منطق العمل ]
local remote = ReplicatedStorage:WaitForChild("HDAdminHDClient"):WaitForChild("Signals"):WaitForChild("RequestCommandSilent")
local antiSpamActive, attackLoop = false, false
local isHeadless, isSkybox = false, false

CloseBtn.MouseButton1Click:Connect(function() MainFrame.Visible = false; OpenBtn.Visible = true end)
OpenBtn.MouseButton1Click:Connect(function() MainFrame.Visible = true; OpenBtn.Visible = false end)

PrefixInput:GetPropertyChangedSignal("Text"):Connect(function() currentPrefix = PrefixInput.Text end)

LoopBtn.MouseButton1Click:Connect(function()
    ClickEffect(LoopBtn)
    local count = tonumber(LoopCountInput.Text) or 1
    if CommandInput.Text ~= "" then
        for i = 1, count do 
            task.spawn(function() remote:InvokeServer(CommandInput.Text) end) 
        end
    end
end)

AttackBtn.MouseButton1Click:Connect(function()
    ClickEffect(AttackBtn)
    attackLoop = not attackLoop
    AttackBtn.Text = attackLoop and "ATTACKING... (MAX)" or "INSTANE ATTACK: OFF"
    AttackBtn.BackgroundColor3 = attackLoop and Color3.fromRGB(150, 0, 0) or Color3.fromRGB(255, 20, 60)
    if attackLoop then
        task.spawn(function()
            while attackLoop do
                if TargetInput.Text ~= "" then
                    for _, cmd in ipairs(attackCommands) do
                        -- سرعة هائلة باستخدام الـ Threads
                        task.spawn(function() 
                            remote:InvokeServer(currentPrefix .. cmd:gsub("%[target%]", TargetInput.Text)) 
                        end)
                    end
                end
                task.wait(0.01) -- سرعة قصوى
            end
        end)
    end
end)

HeadlessBtn.MouseButton1Click:Connect(function() 
    isHeadless = not isHeadless
    if isHeadless then remote:InvokeServer(currentPrefix .. "head me 134082579") HeadlessBtn.Text = "HIDDEN HEAD: ON"
    else remote:InvokeServer(currentPrefix .. "re me") HeadlessBtn.Text = "HIDDEN HEAD" end
end)

SkyboxBtn.MouseButton1Click:Connect(function() 
    isSkybox = not isSkybox
    if isSkybox then
        remote:InvokeServer(currentPrefix .. "skybox 15117424103") 
        remote:InvokeServer(currentPrefix .. "bundle me 148351107651039")
        remote:InvokeServer(currentPrefix .. "emote me 93224413172183")
        SkyboxBtn.Text = "SKYBOX & EMOTE: ON"
    else remote:InvokeServer(currentPrefix .. "re me") remote:InvokeServer(currentPrefix .. "unskybox") SkyboxBtn.Text = "SKYBOX & EMOTE" end
end)

AntiSpamBtn.MouseButton1Click:Connect(function()
    antiSpamActive = not antiSpamActive
    AntiSpamBtn.Text = antiSpamActive and "ANTI SPAM: ON ✅" or "ANTI SPAM: OFF ❌"
    AntiSpamBtn.BackgroundColor3 = antiSpamActive and Color3.fromRGB(0, 200, 100) or Color3.fromRGB(30, 30, 35)
end)

-- [ نظام الحماية القوي ]
RunService.Heartbeat:Connect(function()
    if antiSpamActive then
        pcall(function()
            for _, v in ipairs(plr.PlayerGui:GetDescendants()) do
                if v.Name:find("Notice") or v.Name:find("Logs") or v.Name:find("Alert") then 
                    v:Destroy() 
                end
            end
        end)
    end
end)
